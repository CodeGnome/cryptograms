#!/usr/bin/env ruby

require_relative '../lib/cryptograms'

notices = [
  "Cryptograms v#{Cryptograms::VERSION}",
  'Copyright Â© 2015, 2016 Todd A. Jacobs',
  'This program is licensed under GPLv3 or later.',
]
warn "#{notices.join ?\n}\n\n"

# Get plaintext from files, standard input, or command-line arguments,
# in that order.
case
when ARGV[0] == '-h' || ARGV.empty?
  cmd = File.basename $0
  msg = "Usage:\n\t#{cmd} -h\n\t#{cmd} <file>\n\t#{cmd} <string ...>"
  warn msg
when ARGV[0] && File.exists?(ARGV[0])
  puts Cryptogram.new(File.read ARGV[0]).cyphertext
when STDIN.tty?
  puts Cryptogram.new(ARGV.join ' ').cyphertext
else
  plaintext = STDIN.gets.chomp
  puts Cryptogram.new(plaintext).cyphertext
end
